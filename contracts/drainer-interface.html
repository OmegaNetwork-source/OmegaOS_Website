<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wallet Drainer - Educational Demo</title>
    <script src="https://cdn.ethers.io/lib/ethers-5.7.2.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            color: #856404;
        }

        .warning strong {
            display: block;
            margin-bottom: 5px;
        }

        .input-group {
            margin: 20px 0;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }

        input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 10px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            background: #f8f9fa;
            border-left: 4px solid #667eea;
        }

        .status p {
            margin: 5px 0;
            color: #555;
        }

        .status strong {
            color: #333;
        }

        .log {
            margin-top: 20px;
            padding: 15px;
            background: #000;
            color: #0f0;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }

        .log div {
            margin: 5px 0;
        }

        .error {
            color: #f00;
        }

        .success {
            color: #0f0;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üéì Wallet Drainer Demo</h1>
        <p style="color: #666; margin-bottom: 20px;">Educational smart contract for testnet demonstration</p>

        <div class="warning">
            <strong>‚ö†Ô∏è EDUCATIONAL USE ONLY</strong>
            This is a demonstration of how malicious contracts work. Only use on testnets like Sepolia, Goerli, or
            Mumbai. Never deploy to mainnet or use with real funds.
        </div>

        <div class="input-group">
            <label>Contract Address (Deploy first using Remix)</label>
            <input type="text" id="contractAddress" placeholder="0x...">
        </div>

        <div class="input-group">
            <label>Recipient Wallet (Where funds will be sent)</label>
            <input type="text" id="recipientAddress" placeholder="0x...">
        </div>

        <div class="input-group">
            <label>Amount to Send (ETH)</label>
            <input type="number" id="amount" placeholder="0.01" step="0.001" value="0.01">
        </div>

        <button id="connectBtn" onclick="connectWallet()">Connect Wallet</button>
        <button id="setRecipientBtn" onclick="setRecipient()" disabled>Set Recipient Wallet</button>
        <button id="drainBtn" onclick="drainWallet()" disabled>Send ETH (Will be Drained)</button>

        <div class="status" id="status" style="display: none;">
            <p><strong>Connected:</strong> <span id="connectedAddress">-</span></p>
            <p><strong>Network:</strong> <span id="network">-</span></p>
            <p><strong>Balance:</strong> <span id="balance">-</span> ETH</p>
        </div>

        <div class="log" id="log"></div>
    </div>

    <script>
        let provider;
        let signer;
        let contract;
        let userAddress;

        const CONTRACT_ABI = [
            "function setRecipient(address payable _newRecipient) external",
            "function drainETH() external payable",
            "function getBalance() external view returns (uint256)",
            "function recipientWallet() external view returns (address)",
            "event FundsReceived(address indexed from, uint256 amount)",
            "event FundsDrained(address indexed from, address indexed to, uint256 amount)"
        ];

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = type;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        async function connectWallet() {
            try {
                if (typeof window.ethereum === 'undefined') {
                    alert('Please install MetaMask!');
                    return;
                }

                log('Connecting to wallet...');
                provider = new ethers.providers.Web3Provider(window.ethereum);
                await provider.send("eth_requestAccounts", []);
                signer = provider.getSigner();
                userAddress = await signer.getAddress();

                const network = await provider.getNetwork();
                const balance = await provider.getBalance(userAddress);

                document.getElementById('connectedAddress').textContent =
                    userAddress.substring(0, 6) + '...' + userAddress.substring(38);
                document.getElementById('network').textContent = network.name;
                document.getElementById('balance').textContent =
                    ethers.utils.formatEther(balance);
                document.getElementById('status').style.display = 'block';

                document.getElementById('connectBtn').disabled = true;
                document.getElementById('setRecipientBtn').disabled = false;
                document.getElementById('drainBtn').disabled = false;

                log(`Connected: ${userAddress}`, 'success');
                log(`Network: ${network.name}`, 'success');

            } catch (error) {
                log(`Error: ${error.message}`, 'error');
            }
        }

        async function setRecipient() {
            try {
                const contractAddr = document.getElementById('contractAddress').value;
                const recipientAddr = document.getElementById('recipientAddress').value;

                if (!contractAddr || !recipientAddr) {
                    alert('Please enter both contract and recipient addresses');
                    return;
                }

                log('Setting recipient wallet...');
                contract = new ethers.Contract(contractAddr, CONTRACT_ABI, signer);

                const tx = await contract.setRecipient(recipientAddr);
                log(`Transaction sent: ${tx.hash}`, 'success');

                await tx.wait();
                log('Recipient wallet set successfully!', 'success');

            } catch (error) {
                log(`Error: ${error.message}`, 'error');
            }
        }

        async function drainWallet() {
            try {
                const contractAddr = document.getElementById('contractAddress').value;
                const amount = document.getElementById('amount').value;

                if (!contractAddr || !amount) {
                    alert('Please enter contract address and amount');
                    return;
                }

                log(`Sending ${amount} ETH to contract...`);
                contract = new ethers.Contract(contractAddr, CONTRACT_ABI, signer);

                const tx = await contract.drainETH({
                    value: ethers.utils.parseEther(amount)
                });

                log(`Transaction sent: ${tx.hash}`, 'success');
                log('‚ö†Ô∏è Funds will be automatically drained to recipient!', 'error');

                const receipt = await tx.wait();
                log('Transaction confirmed!', 'success');
                log(`Gas used: ${receipt.gasUsed.toString()}`, 'info');

                // Update balance
                const balance = await provider.getBalance(userAddress);
                document.getElementById('balance').textContent =
                    ethers.utils.formatEther(balance);

            } catch (error) {
                log(`Error: ${error.message}`, 'error');
            }
        }
    </script>
</body>

</html>